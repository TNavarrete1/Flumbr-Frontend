<app-notification-panel></app-notification-panel>

<div id="{{theme}}" class="{{theme}} space-y-5 flex-row" xmlns="http://www.w3.org/1999/html">

  <div class="m-32 mt-0 space-y-5">
    <!-- Button for user to start/stop modifying bio -->
    <button mat-raised-button color="primary"  (click)="modifyProfileBio()">Modify Profile?</button>

    <mat-form-field *ngIf="modifyBio">
      <mat-label>Select a theme</mat-label>
      <mat-select>
        <mat-option (click)="selectTheme('theme-one')" value="theme-one">Theme One</mat-option>
        <mat-option (click)="selectTheme('theme-two')" value="theme-two">Theme Two</mat-option>
        <mat-option (click)="selectTheme('theme-three')" value="theme-three">Theme Three</mat-option>
        <mat-option (click)="selectTheme('theme-four')" value="theme-four">Theme Four</mat-option>
        <mat-option (click)="selectTheme('theme-five') "value="theme-five">Theme Five</mat-option>
      </mat-select>
    </mat-form-field>

    <!-- follow / unfollow  -->
    <!-- {{profile | json}} -->
    <app-follow
      viewTemplate="iconView"
      [followIdentity]="{
              loggedInUserId: 'this should be the logged in user id',
              ownerUserId: profile.id,
              ownerUsername: profile.username}">

    </app-follow>

    <div class="space-y-5">
      <mat-card  class="flex items-center justify-center  rounded-b-md">
        <mat-card-header class="flex-row p-4 space-y-10">
          <mat-card-title-group>
            <mat-card-title class="w-1/3 text-9xl">{{profile.username}}</mat-card-title>

            <mat-card>
              <img mat-card-image src="{{profile.profile_img}}" class="object-contain w-1/3">

              <div *ngIf="modifyBio && !isImage" class="">
                <ngx-dropzone (change)="onSetImage($event)" [multiple]=false>
                  <ngx-dropzone-label>Drag and drop media or <span class="border-2 rounded-full p-2">Upload</span></ngx-dropzone-label>
                  <ngx-dropzone-preview *ngFor="let f of files" [removable]="true" (removed)="onRemove(f)">
                    <ngx-dropzone-label>{{ f.name }} ({{ f.type }})</ngx-dropzone-label>
                  </ngx-dropzone-preview>
                </ngx-dropzone>
              </div>
              <div
                class="w-screen lg:w-1/2"
                *ngIf="isImage && modifyBio">
                <h3 class="font-bold">Preview:</h3>
                <ng-container *ngIf="isImage">
                  <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview" *ngFor="let f of files" [file]="f">
                    <ngx-dropzone-label></ngx-dropzone-label>
                  </ngx-dropzone-image-preview>
                </ng-container>
              </div>

            </mat-card>



          </mat-card-title-group>
        </mat-card-header>

        <div class="">
          <p *ngIf="modifyBio==false" class="text-2xl">Profile Bio: {{profile.bio}}</p>
          <!-- Form for submitting bio, only toggled when modify is set to true -->

          <div *ngIf="modifyBio == true" class="flex flex-col border-8 border-indigo-600">
            <form [formGroup]="changeBioForm" (submit)="submitForm()">
              <mat-form-field class="form-field" class="w-full">
                <mat-label> {{profile.bio}} </mat-label>
                <input matInput formControlName="bio">
              </mat-form-field>
              <button mat-raised-button color="accent" type="submit"> Submit bio</button>
            </form>
          </div>
        </div>

        <div *ngIf="modifyBio" class="flex flex-col mr-auto">
          <div class="">
            <p>
              <em>Enter tags</em>
            </p>

            <form [formGroup]="tagsForm" class="flex flex-col">
              <mat-form-field class="form-field">
                <mat-label>Profile tags</mat-label>
                <mat-chip-grid #chipGrid aria-label="Enter tags" formControlName="tags">
                  <mat-chip-row 
                    *ngFor="let tag of tags"
                    (removed)="removeTag(tag)"
                    [style.background-color]="'#ff3f80'">
                    {{tag.name}}
                    <button matChipRemove aria-label="'remove ' + keyword">
                      <mat-icon>cancel</mat-icon>
                    </button>
                  </mat-chip-row>
                </mat-chip-grid>
                <input placeholder="New tag..."
                        [matChipInputFor]="chipGrid"
                        (matChipInputTokenEnd)="addTag($event)"/>
              </mat-form-field>
              <button mat-raised-button color="accent" type="submit">Update tags</button>
            </form>
          </div>
        </div>
      </mat-card>
    </div>
    <app-trending-posts></app-trending-posts>

  </div>


</div>

